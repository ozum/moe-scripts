{"version":3,"sources":["../../src/scripts/init.js"],"names":["require","install","mkdirp","path","fs","yargsParser","handlebars","isTypeScript","createSymLink","createFile","copyFile","writeJson","createModuleSymLink","setPkg","pkg","args","process","argv","slice","parsedArgs","array","isCompiled","target","includes","isBackend","configFile","join","__dirname","p","gitignoreFile","force","compile","readFileSync","encoding","extends"],"mappings":"AAAA;;;AAGAA,QAAQ,oBAAR,EAA8BC,OAA9B;;AACA,IAAMC,SAASF,QAAQ,QAAR,CAAf;;AACA,IAAMG,OAAOH,QAAQ,MAAR,CAAb;;AACA,IAAMI,KAAKJ,QAAQ,IAAR,CAAX;;AACA,IAAMK,cAAcL,QAAQ,cAAR,CAApB;;AACA,IAAMM,aAAaN,QAAQ,YAAR,CAAnB;;eACsGA,QAAQ,cAAR,C;IAA9FO,Y,YAAAA,Y;IAAcC,a,YAAAA,a;IAAeC,U,YAAAA,U;IAAYC,Q,YAAAA,Q;IAAUC,S,YAAAA,S;IAAWC,mB,YAAAA,mB;IAAqBC,M,YAAAA,M;;gBAC3Eb,QAAQ,UAAR,C;IAARc,G,aAAAA,G,EACR;;;AAEA,IAAMC,OAAOC,QAAQC,IAAR,CAAaC,KAAb,CAAmB,CAAnB,CAAb;AACA,IAAMC,aAAad,YAAYU,IAAZ,EAAkB;AAAEK,SAAO,CAAC,QAAD;AAAT,CAAlB,CAAnB;AAEA,IAAMC,aAAa,CAACF,WAAWG,MAAX,IAAqB,EAAtB,EAA0BC,QAA1B,CAAmC,UAAnC,KAAkDhB,YAArE;AACA,IAAMiB,YAAY,CAAC,CAACL,WAAWG,MAAX,IAAqB,EAAtB,EAA0BC,QAA1B,CAAmC,UAAnC,CAAnB,C,CAEA;;AACA,IAAME,aAAa;AAAA,SAAKtB,KAAKuB,IAAL,CAAUC,SAAV,EAAqB,WAArB,EAAkCC,CAAlC,CAAL;AAAA,CAAnB;;AACA,IAAMC,gBAAgBR,aAAa,SAAb,GAAyB,aAA/C;AAEAR,OAAO;AACL,mBAAkB,oBAAmBN,eAAe,EAAf,GAAoB,gBAAiB,EADrE;AAEL,uBAAsB,4BAFjB;AAGL,kBAAgB,kBAHX;AAIL,yBAAuB,mCAJlB;AAKL,kBAAgB,kBALX;AAML,oBAAkB,oBANb;AAOL,sBAAoB,sBAPf;AAQL,yBAAuB,4CARlB;AASL,4BAA0B;AATrB,CAAP,E,CAYA;AACA;AACA;;AAEAE,WAAW,MAAX,EAAmB,EAAnB;AACAA,WAAW,aAAX,EAA0B,gCAA1B;AACAD,cAAciB,WAAY,aAAYI,aAAc,EAAtC,CAAd,EAAwD,YAAxD,EAAsE;AAAEC,SAAO;AAAT,CAAtE;AACAtB,cAAciB,WAAY,eAAZ,CAAd,EAA2C,gBAA3C,EAA6D;AAAEK,SAAO;AAAT,CAA7D;AACApB,SAASe,WAAW,cAAX,CAAT,EAAqC,cAArC;AACAhB,WAAW,SAAX,EAAsB,EAAtB;AACAA,WAAW,YAAX,EAAyBH,WAAWyB,OAAX,CAAmB3B,GAAG4B,YAAH,CAAgBP,WAAW,YAAX,CAAhB,EAA0C;AAAEQ,YAAU;AAAZ,CAA1C,CAAnB,EAAoFnB,GAApF,CAAzB;AACAL,WAAW,gBAAX,EAA6B,wDAA7B;AACAA,WAAW,aAAX,EAA0B,qDAA1B,E,CAEA;AACA;;AACA,IAAIF,YAAJ,EAAkB;AAChBK,sBAAoB,QAApB;AACAD,YAAU,aAAV,EAAyB;AAAEuB,aAAS;AAAX,GAAzB;AACD,CAHD,MAGO;AACLtB,sBAAoB,QAApB;AACAD,YAAU,WAAV,EAAuB;AAAEuB,aAAS;AAAX,GAAvB;AACD,C,CAED;;;AACA,IAAI3B,YAAJ,EAAkB;AAChBC,gBAAciB,WAAW,uBAAX,CAAd,EAAmD,eAAnD;AACAjB,gBAAciB,WAAW,4BAAX,CAAd,EAAwD,oBAAxD;AACD,C,CAED;AACA;AACA","file":"init.js","sourcesContent":["/**\n * --target frontend | backend | compiled (Mulitple selection)\n */\nrequire(\"source-map-support\").install();\nconst mkdirp = require(\"mkdirp\");\nconst path = require(\"path\");\nconst fs = require(\"fs\");\nconst yargsParser = require(\"yargs-parser\");\nconst handlebars = require(\"handlebars\");\nconst { isTypeScript, createSymLink, createFile, copyFile, writeJson, createModuleSymLink, setPkg } = require(\"../utils-moe\");\nconst { pkg } = require(\"../utils\");\n// const { outDir, create, customize } = require(\"./utils\");\n\nconst args = process.argv.slice(2);\nconst parsedArgs = yargsParser(args, { array: [\"target\"] });\n\nconst isCompiled = (parsedArgs.target || []).includes(\"compiled\") || isTypeScript;\nconst isBackend = !(parsedArgs.target || []).includes(\"frontend\");\n\n//const here = p => path.join(__dirname, p);\nconst configFile = p => path.join(__dirname, \"../config\", p);\nconst gitignoreFile = isCompiled ? \"compile\" : \"non-compile\";\n\nsetPkg({\n  \"scripts.build\": `moe-scripts build${isTypeScript ? '' : ' --source-maps'}`,\n  \"scripts.build:doc\": `moe-scripts doc --no-cache`,\n  \"scripts.test\": \"moe-scripts test\",\n  \"scripts.test:update\": \"moe-scripts test --updateSnapshot\",\n  \"scripts.lint\": \"moe-scripts lint\",\n  \"scripts.format\": \"moe-scripts format\",\n  \"scripts.validate\": \"moe-scripts validate\",\n  \"scripts.postversion\": \"git push && git push --tags && npm publish\",\n  \"scripts.prepublishOnly\": \"npm run build\",\n});\n\n//mkdirp.sync(\"node_modules/@types\");\n//createModuleSymLink(\"@types/jest\");\n//createModuleSymLink(\"@types/node\");\n\ncreateFile(\".env\", \"\");\ncreateFile(\".env.sample\", \"# Description\\n# VAR='value'\\n\");\ncreateSymLink(configFile(`gitignore/${gitignoreFile}`), \".gitignore\", { force: true });\ncreateSymLink(configFile(`gitattributes`), \".gitattributes\", { force: true });\ncopyFile(configFile(\"changelog.md\"), \"CHANGELOG.md\");\ncreateFile(\"LICENSE\", \"\");\ncreateFile(\"README.hbs\", handlebars.compile(fs.readFileSync(configFile(\"readme.hbs\"), { encoding: \"utf8\" }))(pkg));\ncreateFile(\".prettierrc.js\", 'module.exports = require(\"moe-scripts/prettier.js\");\\n');\ncreateFile(\".huskyrc.js\", 'module.exports = require(\"moe-scripts/husky.js\");\\n');\n\n// lint\n// Create node_modules/module symlink for IDE support and config file if not exists.\nif (isTypeScript) {\n  createModuleSymLink(\"tslint\");\n  writeJson(\"tslint.json\", { extends: \"moe-scripts/tslint-backend.json\" });\n} else {\n  createModuleSymLink(\"eslint\");\n  writeJson(\".eslintrc\", { extends: \"./node_modules/moe-scripts/eslint.js\" });\n}\n\n// compiler\nif (isTypeScript) {\n  createSymLink(configFile(\"tsconfig/backend.json\"), \"tsconfig.json\");\n  createSymLink(configFile(\"tsconfig/backend-test.json\"), \"tsconfig-test.json\");\n}\n\n// Format\n//createModuleSymLink(\"prettier\");\n//createModuleSymLink(\"ts-jest\");\n"]}